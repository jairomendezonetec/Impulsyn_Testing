{"version":3,"sources":["./src/app/opportunity-detail/opportunity-detail.page.html","./src/app/opportunity-detail/opportunity-detail-routing.module.ts","./src/app/opportunity-detail/opportunity-detail.module.ts","./src/app/opportunity-detail/opportunity-detail.page.scss","./src/app/opportunity-detail/opportunity-detail.page.ts"],"names":[],"mappings":"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","file":"opportunity-detail-opportunity-detail-module.js","sourcesContent":["export default \"<app-header [showBackButton]=\\\"true\\\" [title]=\\\"'opportunity.title'\\\" (backButtonClick)=\\\"goBack()\\\"></app-header>\\n\\n<ion-content>\\n  <div class=\\\"item-profile\\\">\\n    <app-opportunity-item [info]=\\\"jobOffer\\\" [hasPhoto]=\\\"true\\\" (itemClick)=\\\"onItemClick($event)\\\"> </app-opportunity-item>\\n  </div>\\n  <ion-grid class=\\\"regular-small-size ion-padding ion-margin\\\">\\n    <ion-row *ngIf=\\\"jobOffer.description\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'formFields.description' | translate}}</span>\\n          <p class=\\\"respectLineJumps\\\">{{jobOffer.description}}</p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"jobOffer.responsibilities\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'formFields.responsibilities' | translate}}</span>\\n          <p class=\\\"respectLineJumps\\\">{{ jobOffer.responsibilities }}</p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"jobOffer.requirements\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'formFields.requirements' | translate}}</span>\\n          <p class=\\\"respectLineJumps\\\">{{ jobOffer.requirements }}</p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"jobOffer.work_area\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'formFields.workArea' | translate}}</span>\\n          <p>{{'workArea.' + jobOffer.work_area?.name | translate}}</p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"jobOffer.sports.length > 0\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'sports.sportRelatedDetail' | translate}}</span>\\n          <p>\\n            <span *ngFor=\\\"let item of jobOffer.sports; index as i\\\">\\n              {{ 'sports.' + item.name | translate }}{{(i === jobOffer.sports.length - 1) ? '' : ','}}\\n            </span>\\n          </p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"jobOffer.opportunity_type\\\">\\n      <ion-col>\\n        <ion-text>\\n          <span class=\\\"bold\\\">{{ 'formFields.opportunityType' | translate}}</span>\\n          <p>{{'opportunityType.' + jobOffer.opportunity_type?.name | translate}}</p>\\n        </ion-text>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n<ion-footer *ngIf=\\\"!editable\\\">\\n  <ion-grid class=\\\"buttons-line footer-grid\\\">\\n    <ion-row class=\\\"flex-row\\\">\\n      <div class=\\\"col-xs-6 ion-justify-content-center\\\" *ngIf=\\\"!isRequested\\\">\\n        <ion-button color=\\\"secondary\\\" (click)=\\\"onRequestButtonClick()\\\"\\n          >{{'pageDetail.requestButton' | translate}}</ion-button\\n        >\\n      </div>\\n      <div class=\\\"col-xs-6 ion-justify-content-center\\\" *ngIf=\\\"isRequested\\\">\\n        <ion-button color=\\\"secondary\\\">{{'pageDetail.requestedButton' | translate}}</ion-button>\\n      </div>\\n      <div class=\\\"col-xs-6 ion-justify-content-center\\\">\\n        <ion-button class=\\\"secondary-button with-icon-end\\\" (click)=\\\"onFavouriteButtonClick()\\\"\\n          >{{ 'pageDetail.favoriteButton' | translate}}\\n          <ion-icon name=\\\"{{(isFavourite)?'heart': 'heart-outline'}}\\\" color=\\\"secondary\\\"></ion-icon>\\n        </ion-button>\\n      </div>\\n    </ion-row>\\n  </ion-grid>\\n</ion-footer>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { OpportunityDetailPage } from './opportunity-detail.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: OpportunityDetailPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class OpportunityDetailPageRoutingModule {}\n","import { NgModule } from '@angular/core';\n\nimport { OpportunityDetailPageRoutingModule } from './opportunity-detail-routing.module';\n\nimport { OpportunityDetailPage } from './opportunity-detail.page';\nimport { SharedModule } from '../@shared/shared.module';\nimport { RequestMessageModalModule } from '../@shared/components/request-message-modal/request-message-modal.module';\n\n@NgModule({\n  imports: [SharedModule, OpportunityDetailPageRoutingModule, RequestMessageModalModule],\n  declarations: [OpportunityDetailPage],\n})\nexport class OpportunityDetailPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL29wcG9ydHVuaXR5LWRldGFpbC9vcHBvcnR1bml0eS1kZXRhaWwucGFnZS5zY3NzIn0= */\";","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { BasePage } from '../base/base.page';\nimport { Subscription } from 'rxjs';\nimport { Location } from '@angular/common';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Store } from '@ngxs/store';\nimport { UtilsService } from '../@core/utils.service';\nimport { ModalController } from '@ionic/angular';\nimport { IJobOffer } from '../@store/job-offers/job-offers.model';\nimport { JobOffersState } from '../@store/job-offers/job-offers.state';\nimport {\n  AddJobOfferFavourite,\n  DeleteJobOfferFavourite,\n  GetJobOffersFavourites,\n  GetJobOffersRequested,\n  RequestEmailJobOffer,\n} from '../@store/job-offers/job-offers.actions';\nimport { FormGroup } from '@angular/forms';\nimport { Utils } from '../@global/utils';\nimport { RequestMessageModalComponent } from '../@shared/components/request-message-modal/request-message-modal.component';\nimport { OfferRequestInput } from '../../API';\nimport { take } from 'rxjs/operators';\nimport { InformService } from '../@core/inform.service';\n\n@Component({\n  selector: 'app-opportunity-detail',\n  templateUrl: './opportunity-detail.page.html',\n  styleUrls: ['./opportunity-detail.page.scss'],\n})\nexport class OpportunityDetailPage extends BasePage implements OnInit, OnDestroy {\n  public jobOfferId: string;\n  public jobOffer: IJobOffer;\n  private favourites: IJobOffer[] = [];\n  private requests: IJobOffer[] = [];\n  public editable: boolean;\n  public isFavourite = false;\n  private jobOfferSub: Subscription;\n  public formGroup: FormGroup;\n  public isRequested = false;\n  private requestsSub: Subscription;\n  private favouriteSub: Subscription;\n\n  constructor(\n    location: Location,\n    router: Router,\n    store: Store,\n    utilsService: UtilsService,\n    private route: ActivatedRoute,\n    private modalController: ModalController,\n    private informService: InformService\n  ) {\n    super(location, router, store, utilsService);\n  }\n\n  ngOnInit() {\n    this.jobOfferId = this.route.snapshot.params['id'];\n    this.jobOfferSub = this.store.select(JobOffersState.getCurrentJobOffer).subscribe((res: IJobOffer) => {\n      if (!res) {\n        return;\n      }\n      this.jobOffer = res;\n      this.editable = this.jobOffer?.own;\n\n      this.isFavouriteLogic();\n      this.isRequestedLogic();\n    });\n  }\n\n  private isRequestedLogic() {\n    this.store.dispatch(new GetJobOffersRequested());\n    this.requestsSub = this.store.select(JobOffersState.getJobOffersRequested).subscribe((data) => {\n      if (!data) {\n        return;\n      }\n      this.requests = data;\n      this.isRequested = this.searchInRequests();\n    });\n  }\n\n  private isFavouriteLogic() {\n    this.store.dispatch(new GetJobOffersFavourites());\n    this.favouriteSub = this.store.select(JobOffersState.getJobOffersFavourites).subscribe((data) => {\n      if (!data) {\n        return;\n      }\n      this.favourites = data;\n      this.isFavourite = this.searchInFavourites();\n    });\n  }\n\n  private searchInRequests() {\n    return Utils.isItemOnList(this.requests, this.jobOfferId);\n  }\n\n  private searchInFavourites() {\n    return Utils.isItemOnList(this.favourites, this.jobOfferId);\n  }\n\n  public onRequestButtonClick() {\n    if (this.jobOffer.contact_email) {\n      this.openRequestModal();\n    } else if (this.jobOffer.website) {\n      // Open web\n      this.utilsService.openLink(this.jobOffer.website);\n    }\n  }\n\n  private async openRequestModal() {\n    const modal = await this.modalController.create({\n      component: RequestMessageModalComponent,\n      componentProps: {\n        type: 'opportunity',\n      },\n    });\n\n    modal.onDidDismiss().then((response) => {\n      if (response.data) {\n        console.dir(response.data);\n\n        const modalFormData = {\n          message: response.data.message,\n          contact_email: response.data.contactEmail,\n          contact_phone: response.data.contactPhone,\n          contact_name: response.data.name,\n          surname: response.data.surname,\n        } as OfferRequestInput;\n\n        this.store\n          .dispatch(\n            new RequestEmailJobOffer({\n              id: this.jobOffer.id,\n              input: modalFormData,\n              jobOffer: this.jobOffer,\n              resume: response.data.resume,\n            })\n          )\n          .pipe(take(1))\n          .subscribe(() => {\n            this.informService.showInfo('requestSuccess');\n            this.isRequested = true;\n          });\n      }\n    });\n\n    return await modal.present();\n  }\n\n  public onFavouriteButtonClick() {\n    if (this.isFavourite) {\n      this.store.dispatch(new DeleteJobOfferFavourite(this.jobOffer.id));\n    } else {\n      this.store.dispatch(new AddJobOfferFavourite(this.jobOffer));\n    }\n  }\n\n  private disconnectObservers(): void {\n    if (this.jobOfferSub) {\n      this.jobOfferSub.unsubscribe();\n    }\n    if (this.requestsSub) {\n      this.requestsSub.unsubscribe();\n    }\n    if (this.favouriteSub) {\n      this.favouriteSub.unsubscribe();\n    }\n  }\n\n  public onItemClick($event) {\n    this.router.navigate([\n      'organization-profile',\n      this.store.selectSnapshot(JobOffersState.getCurrentJobOffer).organization_id,\n    ]);\n  }\n\n  ngOnDestroy() {\n    this.disconnectObservers();\n  }\n}\n"],"sourceRoot":"webpack:///"}