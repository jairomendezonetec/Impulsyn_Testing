{"version":3,"sources":["./src/app/chats/chat-detail/chat-detail.page.html","./src/app/chats/components/chat-message/chat-message.component.html","./src/app/chats/chat-detail/chat-detail-routing.module.ts","./src/app/chats/chat-detail/chat-detail.module.ts","./src/app/chats/chat-detail/chat-detail.page.scss","./src/app/chats/chat-detail/chat-detail.page.ts","./src/app/chats/components/chat-message/chat-message.component.scss","./src/app/chats/components/chat-message/chat-message.component.ts","./src/app/chats/components/chat-message/chat-message.module.ts"],"names":[],"mappings":"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","file":"chats-chat-detail-chat-detail-module.js","sourcesContent":["export default \"<app-header\\n  [showBackButton]=\\\"showBackButton\\\"\\n  [title]=\\\"otherParticipant ? otherParticipant.complete_name : otherParticipantCompleteName | translate\\\"\\n  (backButtonClick)=\\\"goBack()\\\"\\n>\\n</app-header>\\n\\n<ion-content class=\\\"item-list\\\">\\n  <div class=\\\"chat-container\\\">\\n    <div #chatContainer class=\\\"messages-container\\\">\\n      <div *ngIf=\\\"showInfiniteScroll\\\" class=\\\"loading-spinner\\\">\\n        <ion-spinner color=\\\"secondary\\\"></ion-spinner>\\n      </div>\\n      <div #chatLoaderTop></div>\\n\\n      <app-chat-message\\n        *ngFor=\\\"let message of currentMessageList?.messages; trackBy: trackByMessages\\\"\\n        [message]=\\\"message\\\"\\n      >\\n      </app-chat-message>\\n    </div>\\n\\n    <!-- Footer -->\\n    <div class=\\\"user-chat-footer\\\">\\n      <div *ngIf=\\\"isNotConnected\\\" class=\\\"small-size\\\">{{'chats.notConnectedWarning'| translate}}</div>\\n      <ion-textarea\\n        class=\\\"chat-textarea\\\"\\n        rows=\\\"1\\\"\\n        name=\\\"message\\\"\\n        [placeholder]=\\\"'chats.writeMessage' | translate\\\"\\n        [(ngModel)]=\\\"newMessage\\\"\\n        [autosize]=\\\"newMessage\\\"\\n        *ngIf=\\\"!isNotConnected\\\"\\n      ></ion-textarea>\\n\\n      <!-- Send button -->\\n      <ion-icon\\n        *ngIf=\\\"!isNotConnected\\\"\\n        name=\\\"send-outline\\\"\\n        color=\\\"secondary\\\"\\n        class=\\\"chat-button\\\"\\n        (click)=\\\"createMessage()\\\"\\n      ></ion-icon>\\n    </div>\\n  </div>\\n</ion-content>\\n\";","export default \"<div class=\\\"item-profile item-message\\\">\\n  <img *ngIf=\\\"message\\\" class=\\\"sender-image\\\" [src]=\\\"message.sender?.photo\\\" (click)=\\\"goToUserProfile()\\\" />\\n\\n  <div class=\\\"message-data\\\">\\n    <div class=\\\"chat-message-info message-text col-xs-10 col-md-10\\\">\\n      <span class=\\\"chat-message-info-title regular-small-size bold\\\">{{ message.sender?.complete_name }}</span>\\n      <span class=\\\"small-size pre-wrap\\\">{{ message.message }}</span>\\n    </div>\\n    <div color=\\\"grey\\\" class=\\\"message-date regular-small-size\\\">\\n      {{ message.creation_date_literal }}\\n    </div>\\n  </div>\\n</div>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ChatDetailPage } from './chat-detail.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatDetailPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ChatDetailPageRoutingModule {}\n","import { NgModule } from '@angular/core';\n\nimport { ChatDetailPageRoutingModule } from './chat-detail-routing.module';\n\nimport { ChatDetailPage } from './chat-detail.page';\nimport { SharedModule } from '../../@shared/shared.module';\nimport { ChatMessageModule } from '../components/chat-message/chat-message.module';\n\n@NgModule({\n  imports: [SharedModule, ChatDetailPageRoutingModule, ChatMessageModule],\n  declarations: [ChatDetailPage],\n})\nexport class ChatDetailPageModule {}\n","export default \".chat-container {\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n}\\n.chat-container .messages-container {\\n  flex: 1 1 auto;\\n  overflow: hidden;\\n  overflow-y: auto;\\n}\\n.chat-container .user-chat-footer {\\n  flex: 0 1 auto;\\n  padding: 10px;\\n  display: flex;\\n  justify-content: space-between;\\n  box-sizing: content-box;\\n  align-items: center;\\n  border-top: 1px solid var(--ion-color-medium);\\n  background-color: var(--ion-background-color);\\n}\\n.chat-container .user-chat-footer .chat-textarea {\\n  margin-right: 10px;\\n  background-color: white;\\n  border-radius: 5px;\\n  margin-top: 0;\\n}\\n.chat-container .user-chat-footer .chat-button {\\n  font-size: 25px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY2hhdHMvY2hhdC1kZXRhaWwvY2hhdC1kZXRhaWwucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsWUFBQTtBQUNGO0FBQ0U7RUFDRSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxnQkFBQTtBQUNKO0FBRUU7RUFDRSxjQUFBO0VBQ0EsYUFBQTtFQUNBLGFBQUE7RUFDQSw4QkFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7RUFDQSw2Q0FBQTtFQUNBLDZDQUFBO0FBQUo7QUFFSTtFQUNFLGtCQUFBO0VBQ0EsdUJBQUE7RUFDQSxrQkFBQTtFQUNBLGFBQUE7QUFBTjtBQUdJO0VBQ0UsZUFBQTtBQUROIiwiZmlsZSI6InNyYy9hcHAvY2hhdHMvY2hhdC1kZXRhaWwvY2hhdC1kZXRhaWwucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNoYXQtY29udGFpbmVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgaGVpZ2h0OiAxMDAlO1xuXG4gIC5tZXNzYWdlcy1jb250YWluZXIge1xuICAgIGZsZXg6IDEgMSBhdXRvO1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgb3ZlcmZsb3cteTogYXV0bztcbiAgfVxuXG4gIC51c2VyLWNoYXQtZm9vdGVyIHtcbiAgICBmbGV4OiAwIDEgYXV0bztcbiAgICBwYWRkaW5nOiAxMHB4O1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgIGJveC1zaXppbmc6IGNvbnRlbnQtYm94O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWlvbi1jb2xvci1tZWRpdW0pO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlvbi1iYWNrZ3JvdW5kLWNvbG9yKTtcblxuICAgIC5jaGF0LXRleHRhcmVhIHtcbiAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgbWFyZ2luLXRvcDogMDtcbiAgICB9XG5cbiAgICAuY2hhdC1idXR0b24ge1xuICAgICAgZm9udC1zaXplOiAyNXB4O1xuICAgIH1cbiAgfVxufVxuIl19 */\";","import { Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { BasePage } from '../../base/base.page';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Location } from '@angular/common';\nimport { Store } from '@ngxs/store';\nimport { UtilsService } from '../../@core/utils.service';\nimport {\n  AddNextChatMessageList,\n  CreateMessage,\n  GetChatMessageList,\n  GetChatMessageListByUserId,\n  SetChatMessagesAsRead,\n} from '../../@store/chats/chats.actions';\nimport { Constants } from '../../@global/constants';\nimport { ChatsState } from '../../@store/chats/chats.state';\nimport { IChatMessageList, IMessage } from '../../@shared/interfaces/chat';\nimport { Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { IUserPublicInfo } from '../../@shared/interfaces/user-public-info';\nimport { AuthState } from '../../@store/auth/auth.state';\nimport { ProfilesState } from '../../@store/profiles/profiles.state';\nimport { USER_CONNECTION_STATUS } from '../../profiles/user/user-profile/user-profile.page';\nimport { IsConnectedWithUser } from '../../@store/profiles/profiles.actions';\n\n@Component({\n  selector: 'app-chat-detail',\n  templateUrl: './chat-detail.page.html',\n  styleUrls: ['./chat-detail.page.scss'],\n})\nexport class ChatDetailPage extends BasePage implements OnInit, OnDestroy {\n  @ViewChild('chatContainer', { static: false }) set chatContainerContent(content: ElementRef) {\n    if (content) {\n      this.chatContainer = content;\n    }\n  }\n\n  @ViewChild('chatLoaderTop', { static: false }) set chatLoaderTopcontent(content: ElementRef) {\n    if (content) {\n      this.chatLoaderTop = content;\n      this.initLoaderIntersector();\n    }\n  }\n\n  private profilePublicInfo$: Subscription;\n  private chatId: string;\n  public otherParticipant: IUserPublicInfo;\n  public currentMessageList: IChatMessageList;\n  private currentChatSubscription: Subscription;\n  public showInfiniteScroll: boolean;\n  public isNotConnected: boolean;\n  public newMessage: string;\n  private subscriptionContacts: Subscription;\n\n  // page elements\n  public chatContainer: ElementRef;\n  public chatLoaderTop: ElementRef;\n\n  // only setted when isNewChat is true\n  public otherParticipantId: string;\n  public otherParticipantCompleteName: string;\n\n  private loaderTopObserver: IntersectionObserver;\n\n  constructor(\n    router: Router,\n    location: Location,\n    store: Store,\n    utilsService: UtilsService,\n    private route: ActivatedRoute\n  ) {\n    super(location, router, store, utilsService);\n  }\n\n  ngOnInit() {\n    this.chatId = this.route.snapshot.params['id'];\n\n    if (this.chatId) {\n      this.loadChatMessageList();\n    } else {\n      this.otherParticipantId = this.route.snapshot.queryParams?.userId;\n      this.otherParticipantCompleteName = this.route.snapshot.queryParams?.completeName;\n      this.store.dispatch(new IsConnectedWithUser({ id: this.otherParticipantId }));\n      this.loadChatMessageListByUserId();\n    }\n\n    this.subscribeToCurrentChat();\n    this.subscribeToIsConnectedWithUser();\n  }\n\n  private subscribeToIsConnectedWithUser(): void {\n    this.profilePublicInfo$ = this.store.select(ProfilesState.isConnectedWithUser).subscribe((result) => {\n      this.isNotConnected = result !== USER_CONNECTION_STATUS.CONNECTED;\n    });\n  }\n\n  private loadChatMessageList() {\n    this.store\n      .dispatch(new GetChatMessageList({ id: this.chatId, input: { limit: Constants.CHAT_MESSAGES_LOAD_LIMIT } }))\n      .pipe(take(1))\n      .subscribe(() => {\n        this.scrollToBottom();\n        this.setChatMessagesAsRead();\n      });\n  }\n\n  private loadChatMessageListByUserId() {\n    this.store\n      .dispatch(\n        new GetChatMessageListByUserId({\n          id: this.otherParticipantId,\n          input: { limit: Constants.CHAT_MESSAGES_LOAD_LIMIT },\n        })\n      )\n      .pipe(take(1))\n      .subscribe(() => {\n        this.scrollToBottom();\n        this.setChatMessagesAsRead();\n      });\n  }\n\n  private setChatMessagesAsRead() {\n    if (this.currentMessageList.chatId) {\n      this.store.dispatch(new SetChatMessagesAsRead(this.currentMessageList.chatId));\n    }\n  }\n\n  private subscribeToCurrentChat() {\n    this.currentChatSubscription = this.store.select(ChatsState.getCurrentChat).subscribe((data) => {\n      if (!data) {\n        return;\n      }\n\n      this.currentMessageList = data;\n      this.otherParticipant = this.getOtherParticipant(data.participants);\n      this.showInfiniteScroll = data.page < data.total_pages;\n\n      if (this.otherParticipant) {\n        this.store.dispatch(new IsConnectedWithUser({ id: this.otherParticipant.id }));\n      }\n    });\n  }\n\n  public loadNextChatMessageList(event?: any) {\n    const nextPage = this.currentMessageList.page + 1;\n\n    if (nextPage <= this.currentMessageList.total_pages) {\n      const previousScrollHeight = this.chatContainer.nativeElement.scrollHeight;\n\n      this.store\n        .dispatch(\n          new AddNextChatMessageList({\n            id: this.chatId,\n            input: { page: nextPage, limit: Constants.CHAT_MESSAGES_LOAD_LIMIT },\n          })\n        )\n        .pipe(take(1))\n        .subscribe(() => {\n          if (event) {\n            event.target.complete();\n          }\n\n          this.keepScroll(previousScrollHeight);\n        });\n    }\n  }\n\n  private initLoaderIntersector(): void {\n    this.loaderTopObserver = new IntersectionObserver(async ([entry]) => {\n      if (entry && entry.isIntersecting) {\n        this.loadNextChatMessageList();\n      }\n    });\n\n    this.loaderTopObserver.observe(this.chatLoaderTop.nativeElement);\n  }\n\n  private getOtherParticipant(participants: IUserPublicInfo[]): IUserPublicInfo {\n    return participants.find((user) => user.id !== this.store.selectSnapshot(AuthState.getUserId));\n  }\n\n  public createMessage(): void {\n    this.store\n      .dispatch(\n        new CreateMessage({\n          receiverId: this.chatId ? this.otherParticipant.id : this.otherParticipantId,\n          message: this.newMessage,\n        })\n      )\n      .pipe(take(1))\n      .subscribe(() => {\n        this.scrollToBottom();\n      });\n\n    this.newMessage = '';\n  }\n\n  private scrollToBottom(): void {\n    this.chatContainer.nativeElement.scrollTop = this.chatContainer.nativeElement.scrollHeight;\n  }\n\n  private keepScroll(previousScrollHeight: number): void {\n    this.chatContainer.nativeElement.scrollTop += this.chatContainer.nativeElement.scrollHeight - previousScrollHeight;\n  }\n\n  public trackByMessages(index: number, item: IMessage): string {\n    return item.id;\n  }\n\n  private disconnectObservers(): void {\n    if (this.currentChatSubscription) {\n      this.currentChatSubscription.unsubscribe();\n    }\n    if (this.subscriptionContacts) {\n      this.subscriptionContacts.unsubscribe();\n    }\n    if (this.profilePublicInfo$) {\n      this.profilePublicInfo$.unsubscribe();\n    }\n  }\n\n  ngOnDestroy() {\n    this.disconnectObservers();\n  }\n}\n","export default \".item-message {\\n  margin-bottom: 0;\\n}\\n.item-message.read {\\n  background: var(--ion-color-primary-contrast);\\n}\\n.item-message.unread {\\n  background: rgba(120, 184, 166, 0.3);\\n}\\n.item-message .sender-image {\\n  flex: 0 0 auto;\\n  align-self: flex-start;\\n  border-radius: 50%;\\n  border: 1px solid var(--ion-color-secondary);\\n  width: 20px;\\n  height: 20px;\\n  overflow: hidden;\\n  padding: 1px;\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n}\\n.item-message .message-text {\\n  display: flex;\\n  flex-direction: column;\\n  padding-left: 10px;\\n}\\n.item-message .message-data {\\n  flex: 1 1 auto;\\n  align-self: flex-start;\\n}\\n.item-message .message-data .chat-message-info {\\n  flex: 1 1 auto;\\n}\\n.item-message .message-data .chat-message-info .chat-message-info-title {\\n  margin-bottom: 5px;\\n}\\n.item-message .message-data .message-date {\\n  flex: 1 0 auto;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY2hhdHMvY29tcG9uZW50cy9jaGF0LW1lc3NhZ2UvY2hhdC1tZXNzYWdlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7QUFDRjtBQUNFO0VBQ0UsNkNBQUE7QUFDSjtBQUVFO0VBQ0Usb0NBQUE7QUFBSjtBQUdFO0VBQ0UsY0FBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSw0Q0FBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxZQUFBO0VBQ0Esb0JBQUE7S0FBQSxpQkFBQTtBQURKO0FBSUU7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtBQUZKO0FBS0U7RUFDRSxjQUFBO0VBQ0Esc0JBQUE7QUFISjtBQUtJO0VBQ0UsY0FBQTtBQUhOO0FBS007RUFDRSxrQkFBQTtBQUhSO0FBT0k7RUFDRSxjQUFBO0FBTE4iLCJmaWxlIjoic3JjL2FwcC9jaGF0cy9jb21wb25lbnRzL2NoYXQtbWVzc2FnZS9jaGF0LW1lc3NhZ2UuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuaXRlbS1tZXNzYWdlIHtcbiAgbWFyZ2luLWJvdHRvbTogMDtcblxuICAmLnJlYWQge1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LWNvbnRyYXN0KTtcbiAgfVxuXG4gICYudW5yZWFkIHtcbiAgICBiYWNrZ3JvdW5kOiByZ2JhKDEyMCwgMTg0LCAxNjYsIDAuMyk7XG4gIH1cblxuICAuc2VuZGVyLWltYWdlIHtcbiAgICBmbGV4OiAwIDAgYXV0bztcbiAgICBhbGlnbi1zZWxmOiBmbGV4LXN0YXJ0O1xuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1pb24tY29sb3Itc2Vjb25kYXJ5KTtcbiAgICB3aWR0aDogMjBweDtcbiAgICBoZWlnaHQ6IDIwcHg7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBwYWRkaW5nOiAxcHg7XG4gICAgb2JqZWN0LWZpdDogY292ZXI7XG4gIH1cblxuICAubWVzc2FnZS10ZXh0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgcGFkZGluZy1sZWZ0OiAxMHB4O1xuICB9XG5cbiAgLm1lc3NhZ2UtZGF0YSB7XG4gICAgZmxleDogMSAxIGF1dG87XG4gICAgYWxpZ24tc2VsZjogZmxleC1zdGFydDtcblxuICAgIC5jaGF0LW1lc3NhZ2UtaW5mbyB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcblxuICAgICAgLmNoYXQtbWVzc2FnZS1pbmZvLXRpdGxlIHtcbiAgICAgICAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICAgICAgfVxuICAgIH1cblxuICAgIC5tZXNzYWdlLWRhdGUge1xuICAgICAgZmxleDogMSAwIGF1dG87XG4gICAgfVxuICB9XG59XG4iXX0= */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { IMessage } from '../../../@shared/interfaces/chat';\n\n@Component({\n  selector: 'app-chat-message',\n  templateUrl: './chat-message.component.html',\n  styleUrls: ['./chat-message.component.scss'],\n})\nexport class ChatMessageComponent implements OnInit {\n  @Input() message: IMessage;\n\n  constructor(private router: Router) {}\n\n  ngOnInit() {}\n\n  public goToUserProfile(): void {\n    this.router.navigate(['/user-profile', this.message.sender.id]);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { ChatMessageComponent } from './chat-message.component';\n\n@NgModule({\n  declarations: [ChatMessageComponent],\n  imports: [IonicModule, TranslateModule.forChild(), CommonModule],\n  exports: [ChatMessageComponent],\n})\nexport class ChatMessageModule {}\n"],"sourceRoot":"webpack:///"}